<Window x:Class="ImageToModelConverter.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="2D Image to 3D Model Converter" Height="700" Width="1200"
        Background="#1E1E1E">
    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="300"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <!-- Left Panel - Controls -->
        <Border Grid.Column="0" Background="#252526" BorderBrush="#3E3E42" BorderThickness="0,0,1,0">
            <ScrollViewer VerticalScrollBarVisibility="Auto">
                <StackPanel Margin="15">
                    <TextBlock Text="2D to 3D Converter" FontSize="18" FontWeight="Bold" 
                               Foreground="#FFFFFF" Margin="0,0,0,20"/>

                    <!-- Image Selection -->
                    <GroupBox Header="Image Source" Foreground="#CCCCCC" Margin="0,0,0,15">
                        <StackPanel Margin="5">
                            <Button x:Name="btnLoadImage" Content="Load Image" 
                                    Height="35" Margin="0,5" Click="BtnLoadImage_Click"
                                    Background="#0E639C" Foreground="White" BorderThickness="0"/>
                            <Image x:Name="imgPreview" Height="150" Margin="0,10" 
                                   Stretch="Uniform" Source="{Binding PreviewImage}"/>
                            <TextBlock x:Name="txtImageInfo" Text="No image loaded" 
                                       Foreground="#999999" FontSize="10" TextWrapping="Wrap"/>
                        </StackPanel>
                    </GroupBox>

                    <!-- Extrusion Settings -->
                    <GroupBox Header="Extrusion Settings" Foreground="#CCCCCC" Margin="0,0,0,15">
                        <StackPanel Margin="5">
                            <TextBlock Text="Extrusion Depth:" Foreground="#CCCCCC" Margin="0,5,0,2"/>
                            <Slider x:Name="sliderDepth" Minimum="0.5" Maximum="10" Value="3" 
                                    TickFrequency="0.5" IsSnapToTickEnabled="True"
                                    ValueChanged="SliderDepth_ValueChanged"/>
                            <TextBlock Text="{Binding ElementName=sliderDepth, Path=Value, StringFormat={}{0:F1}}" 
                                       Foreground="#999999" HorizontalAlignment="Right"/>

                            <TextBlock Text="Detail Level:" Foreground="#CCCCCC" Margin="0,15,0,2"/>
                            <ComboBox x:Name="cmbDetail" SelectedIndex="1" SelectionChanged="CmbDetail_SelectionChanged">
                                <ComboBoxItem Content="Low (Fast)"/>
                                <ComboBoxItem Content="Medium"/>
                                <ComboBoxItem Content="High (Slow)"/>
                            </ComboBox>

                            <TextBlock Text="Extrusion Method:" Foreground="#CCCCCC" Margin="0,15,0,2"/>
                            <ComboBox x:Name="cmbMethod" SelectedIndex="0" SelectionChanged="CmbMethod_SelectionChanged">
                                <ComboBoxItem Content="Depth Map"/>
                                <ComboBoxItem Content="Edge Detection"/>
                                <ComboBoxItem Content="Contour Based"/>
                            </ComboBox>

                            <CheckBox x:Name="chkSmoothNormals" Content="Smooth Normals" 
                                      IsChecked="True" Foreground="#CCCCCC" Margin="0,10"
                                      Checked="ChkSmoothNormals_CheckedChanged" 
                                      Unchecked="ChkSmoothNormals_CheckedChanged"/>
                        </StackPanel>
                    </GroupBox>

                    <!-- Material Settings -->
                    <GroupBox Header="Material" Foreground="#CCCCCC" Margin="0,0,0,15">
                        <StackPanel Margin="5">
                            <TextBlock Text="Color:" Foreground="#CCCCCC" Margin="0,5,0,2"/>
                            <ComboBox x:Name="cmbColor" SelectedIndex="0" SelectionChanged="CmbColor_SelectionChanged">
                                <ComboBoxItem Content="From Image"/>
                                <ComboBoxItem Content="Gray"/>
                                <ComboBoxItem Content="Blue"/>
                                <ComboBoxItem Content="Red"/>
                                <ComboBoxItem Content="Green"/>
                            </ComboBox>

                            <TextBlock Text="Specular:" Foreground="#CCCCCC" Margin="0,15,0,2"/>
                            <Slider x:Name="sliderSpecular" Minimum="0" Maximum="1" Value="0.5" 
                                    ValueChanged="SliderSpecular_ValueChanged"/>
                        </StackPanel>
                    </GroupBox>

                    <!-- Mirror Control - Add to your settings panel -->
                    <Label Content="Mirror:" Grid.Row="7" Grid.Column="0"/>
                    <ComboBox Name="cmbMirror" Grid.Row="7" Grid.Column="1" 
                     SelectionChanged="CmbMirror_SelectionChanged">
                        <ComboBoxItem Content="None" IsSelected="True"/>
                        <ComboBoxItem Content="Mirror X"/>
                        <ComboBoxItem Content="Mirror Y"/>
                        <ComboBoxItem Content="Mirror Z"/>
                    </ComboBox>

                    <!-- Reference Plane Toggle - Add to your buttons section -->
                                <Button Name="btnTogglePlane" Content="Hide Reference Plane" 
                    Grid.Row="8" Grid.Column="0" Grid.ColumnSpan="2"
                    Click="BtnTogglePlane_Click" Margin="5"/>
                    <!-- Actions -->
                    <Button x:Name="btnGenerate" Content="Generate 3D Model" 
                            Height="40" Margin="0,10" Click="BtnGenerate_Click"
                            Background="#16825D" Foreground="White" BorderThickness="0"
                            FontWeight="Bold" FontSize="14"/>

                    <Button x:Name="btnExport" Content="Export Model (OBJ)" 
                            Height="35" Margin="0,5" Click="BtnExport_Click"
                            Background="#0E639C" Foreground="White" BorderThickness="0"
                            IsEnabled="False"/>

                    <TextBlock x:Name="txtStatus" Text="Ready" Foreground="#999999" 
                               Margin="0,15,0,0" TextWrapping="Wrap" FontSize="11"/>
                </StackPanel>
            </ScrollViewer>
        </Border>

        <!-- Right Panel - 3D Viewport -->
        <Border Grid.Column="1" Background="#1E1E1E">
            <Grid>
                <Viewport3D x:Name="viewport3D">
                    <Viewport3D.Camera>
                        <PerspectiveCamera x:Name="camera" 
                                         Position="0,5,15" 
                                         LookDirection="0,-1,-3" 
                                         UpDirection="0,1,0" 
                                         FieldOfView="60"/>
                    </Viewport3D.Camera>

                    <!-- Lighting -->
                    <ModelVisual3D>
                        <ModelVisual3D.Content>
                            <Model3DGroup>
                                <AmbientLight Color="#404040"/>
                                <DirectionalLight Color="#FFFFFF" Direction="-1,-1,-1"/>
                                <DirectionalLight Color="#808080" Direction="1,-0.5,-1"/>
                            </Model3DGroup>
                        </ModelVisual3D.Content>
                    </ModelVisual3D>

                    <!-- 3D Model Container -->
                    <ModelVisual3D x:Name="modelVisual"/>

                </Viewport3D>

                <!-- Overlay Info -->
                <StackPanel VerticalAlignment="Bottom" HorizontalAlignment="Left" 
                           Margin="20" Background="#AA000000">
                    <TextBlock Text="Mouse Controls:" Foreground="White" FontWeight="Bold"/>
                    <TextBlock Text="• Left Click + Drag: Rotate" Foreground="#CCCCCC"/>
                    <TextBlock Text="• Mouse Wheel: Zoom" Foreground="#CCCCCC"/>
                    <TextBlock Text="• Right Click + Drag: Pan" Foreground="#CCCCCC"/>
                </StackPanel>

                <TextBlock x:Name="txtVertexCount" Text="" 
                          VerticalAlignment="Top" HorizontalAlignment="Right"
                          Margin="20" Foreground="#999999" FontSize="11"/>
            </Grid>
        </Border>
    </Grid>
</Window>